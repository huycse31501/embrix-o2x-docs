<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Part 1: Business & Architecture - Embrix O2X</title>
    
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        font-size: 16px;
        line-height: 1.7;
        color: #1f2937;
        background: linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%);
        background-attachment: fixed;
        padding: 20px;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 40px 50px;
        border-radius: 16px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        position: relative;
        overflow: hidden;
    }

    .container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    }

    .nav-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
    }

    .nav-header h1 {
        font-size: 1.4em;
        margin-bottom: 5px;
        font-weight: 600;
    }

    .nav-links {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
    }

    .nav-links a {
        color: white;
        text-decoration: none;
        padding: 8px 16px;
        background: rgba(255,255,255,0.2);
        border-radius: 5px;
        transition: background 0.3s;
    }

    .nav-links a:hover {
        background: rgba(255,255,255,0.3);
    }

    h1 {
        color: #667eea;
        margin: 35px 0 20px 0;
        padding: 12px 0 12px 18px;
        border-left: 5px solid #667eea;
        border-bottom: 2px solid #667eea;
        background: linear-gradient(90deg, rgba(102, 126, 234, 0.05) 0%, rgba(255,255,255,0) 100%);
        font-size: 1.8em;
        font-weight: 700;
        border-radius: 0 8px 0 0;
    }

    h2 {
        color: #764ba2;
        margin: 30px 0 18px 0;
        padding: 10px 0 10px 15px;
        border-left: 4px solid #764ba2;
        border-bottom: 2px solid #f0f0f0;
        background: linear-gradient(90deg, rgba(118, 75, 162, 0.03) 0%, rgba(255,255,255,0) 100%);
        font-size: 1.5em;
        font-weight: 700;
        border-radius: 0 6px 0 0;
    }

    h3 {
        color: #667eea;
        margin: 25px 0 15px 0;
        padding: 8px 0 8px 12px;
        border-left: 3px solid #667eea;
        background: linear-gradient(90deg, rgba(102, 126, 234, 0.04) 0%, transparent 100%);
        font-size: 1.25em;
        font-weight: 600;
        border-radius: 0 6px 6px 0;
    }

    h4 {
        color: #764ba2;
        margin: 20px 0 12px 0;
        padding: 6px 0 6px 10px;
        border-left: 2px solid #764ba2;
        background: linear-gradient(90deg, rgba(118, 75, 162, 0.03) 0%, transparent 100%);
        font-size: 1.1em;
        font-weight: 600;
        border-radius: 0 4px 4px 0;
    }

    h5 {
        color: #667eea;
        margin: 18px 0 10px 0;
        padding: 4px 0 4px 8px;
        border-left: 2px solid #667eea;
        font-size: 1.05em;
        font-weight: 600;
        background: linear-gradient(90deg, rgba(102, 126, 234, 0.02) 0%, transparent 100%);
        border-radius: 0 3px 3px 0;
    }

    h6 {
        color: #764ba2;
        margin: 15px 0 8px 0;
        font-size: 0.95em;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    p {
        margin: 12px 0;
        line-height: 1.7;
        font-size: 0.95em;
        color: #374151;
    }
    
    /* Better spacing for paragraphs after headings */
    h1 + p, h2 + p, h3 + p, h4 + p {
        margin-top: 10px;
    }

    ul, ol {
        margin: 20px 0;
        padding-left: 35px;
    }

    li {
        margin: 10px 0;
        line-height: 1.7;
        font-size: 0.95em;
        position: relative;
        padding-left: 8px;
    }

    ul li::marker {
        color: #667eea;
        font-weight: bold;
        font-size: 1.1em;
    }

    ol li::marker {
        color: #764ba2;
        font-weight: bold;
        font-size: 1em;
    }

    /* Better list item styling */
    li {
        background: linear-gradient(90deg, rgba(102, 126, 234, 0.02) 0%, transparent 100%);
        border-left: 2px solid transparent;
        padding: 8px 8px 8px 12px;
        border-radius: 0 4px 4px 0;
        transition: all 0.2s ease;
    }

    li:hover {
        background: linear-gradient(90deg, rgba(102, 126, 234, 0.05) 0%, transparent 100%);
        border-left-color: #667eea;
        padding-left: 16px;
    }

    /* Nested lists */
    li ul, li ol {
        margin: 8px 0 8px 10px;
    }

    /* Nested list items - smaller styling */
    li li {
        font-size: 0.92em;
        margin: 6px 0;
        background: linear-gradient(90deg, rgba(118, 75, 162, 0.02) 0%, transparent 100%);
    }

    li li:hover {
        background: linear-gradient(90deg, rgba(118, 75, 162, 0.05) 0%, transparent 100%);
        border-left-color: #764ba2;
    }

    code {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        padding: 2px 6px;
        border-radius: 4px;
        font-family: 'Fira Code', 'Courier New', Consolas, monospace;
        font-size: 0.85em;
        color: #d63384;
        border: 1px solid #dee2e6;
        font-weight: 500;
    }

    /* Inline code with special highlighting */
    p code, li code, td code {
        position: relative;
    }

    p code::before, li code::before, td code::before {
        content: '';
        position: absolute;
        inset: -2px;
        border-radius: 5px;
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        z-index: -1;
        opacity: 0;
        transition: opacity 0.2s;
    }

    p code:hover::before, li code:hover::before, td code:hover::before {
        opacity: 1;
    }

    pre {
        background: #1e293b;
        color: #cbd5e1;
        padding: 16px 18px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 18px 0;
        border: 1px solid #334155;
        box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        font-family: 'Cascadia Code', 'Fira Code', 'SF Mono', 'Consolas', 'Liberation Mono', monospace;
        font-size: 0.8em;
        line-height: 1.5;
        position: relative;
        font-feature-settings: "liga" 0;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    pre code {
        background: none;
        color: inherit;
        padding: 0;
        border: none;
        font-family: inherit;
        font-weight: normal;
        font-size: 1em;
    }

    /* Hover effect */
    pre:hover {
        border-color: #475569;
        box-shadow: 0 4px 8px rgba(0,0,0,0.12);
        transition: all 0.3s ease;
    }

    /* Code block header indicator */
    pre::after {
        content: 'CODE';
        position: absolute;
        top: 8px;
        right: 12px;
        font-size: 0.65em;
        color: #64748b;
        font-weight: 600;
        letter-spacing: 0.05em;
        opacity: 0.5;
    }

    blockquote {
        border-left: 4px solid #667eea;
        padding: 15px 20px;
        margin: 20px 0;
        color: #555;
        font-style: italic;
        font-size: 0.95em;
        background: linear-gradient(90deg, rgba(102, 126, 234, 0.05) 0%, rgba(255,255,255,0) 100%);
        border-radius: 0 6px 6px 0;
        position: relative;
    }

    blockquote::before {
        content: '"';
        position: absolute;
        left: -10px;
        top: -10px;
        font-size: 4em;
        color: rgba(102, 126, 234, 0.1);
        font-family: Georgia, serif;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        border-radius: 8px;
        overflow: hidden;
        background: white;
        font-size: 0.9em;
    }

    thead {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    th {
        color: white;
        padding: 12px 15px;
        text-align: left;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.82em;
        letter-spacing: 0.3px;
    }

    td {
        padding: 10px 15px;
        border-bottom: 1px solid #e5e7eb;
        vertical-align: top;
        line-height: 1.6;
    }

    tbody tr:last-child td {
        border-bottom: none;
    }

    tbody tr:hover {
        background: rgba(102, 126, 234, 0.04);
        transition: background 0.2s ease;
    }

    tbody tr:nth-child(even) {
        background: rgba(102, 126, 234, 0.02);
    }

    tbody tr:nth-child(even):hover {
        background: rgba(102, 126, 234, 0.05);
    }
    
    /* Better code in tables */
    td code {
        font-size: 0.85em;
        padding: 2px 6px;
    }

    .info-box {
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        border-left: 5px solid #2196f3;
        padding: 20px;
        margin: 25px 0;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2);
    }

    .warning-box {
        background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
        border-left: 5px solid #ff9800;
        padding: 20px;
        margin: 25px 0;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(255, 152, 0, 0.2);
    }

    .success-box {
        background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
        border-left: 5px solid #4caf50;
        padding: 20px;
        margin: 25px 0;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(76, 175, 80, 0.2);
    }

    /* Better colors for syntax in diagrams */
    pre {
        /* Box drawing characters in nice blue */
        color: #93c5fd;
    }

    /* JSON/code syntax in pre blocks */
    pre {
        white-space: pre;
        word-wrap: normal;
    }

    .toc {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        border-left: 4px solid #667eea;
    }

    .toc h2 {
        color: #667eea;
        border-bottom: none;
        margin-bottom: 15px;
    }

    .toc ul {
        list-style: none;
        padding-left: 0;
    }

    .toc li {
        margin: 8px 0;
    }

    .toc a {
        color: #667eea;
        text-decoration: none;
        transition: color 0.3s;
    }

    .toc a:hover {
        color: #764ba2;
    }

    hr {
        border: none;
        border-top: 2px solid #f0f0f0;
        margin: 30px 0;
    }

    .badge {
        display: inline-block;
        background: #667eea;
        color: white;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 0.85em;
        margin-left: 10px;
    }

    a {
        color: #667eea;
        text-decoration: none;
        transition: color 0.3s;
    }

    a:hover {
        color: #764ba2;
        text-decoration: underline;
    }
    
    /* Better display for metadata fields */
    strong {
        color: #374151;
        font-weight: 600;
    }
    
    /* Metadata field styling - each field on its own line */
    .metadata-field {
        margin: 8px 0;
        padding: 8px 14px;
        background: linear-gradient(90deg, rgba(102, 126, 234, 0.04) 0%, transparent 100%);
        border-left: 3px solid #667eea;
        border-radius: 0 4px 4px 0;
        line-height: 1.7;
        font-size: 0.95em;
        display: block;
        clear: both;
    }
    
    .metadata-field strong {
        color: #667eea;
        font-weight: 600;
        margin-right: 8px;
        display: inline-block;
        min-width: 100px;
    }
    
    .metadata-field code {
        font-size: 0.88em;
    }

    footer {
        margin-top: 50px;
        padding-top: 30px;
        border-top: 2px solid #f0f0f0;
        text-align: center;
        color: #888;
    }

    @media print {
        body {
            background: white;
        }
        .nav-header, .nav-links {
            display: none;
        }
        pre {
            break-inside: avoid;
        }
    }

    @media (max-width: 768px) {
        .container {
            padding: 20px;
        }
        .nav-header {
            flex-direction: column;
            align-items: flex-start;
        }
        .nav-links {
            margin-top: 15px;
        }
        h1 {
            font-size: 2em;
        }
        h2 {
            font-size: 1.5em;
        }
    }
</style>

</head>
<body>
    <div class="container">
        <div class="nav-header"><div><h1>Embrix O2X Documentation</h1><small>Navigate between guides</small></div><div class="nav-links"><a href="index.html">Home</a><a href="guide-index.html">Guide Index</a><a href="part1-business-architecture.html">Part 1</a><a href="part2-technical-deep-dive.html">Part 2</a><a href="part3-services-development.html">Part 3</a><a href="business-scenarios.html">Scenarios</a><a href="multi-tenant-complete-guide.html">Multi-Tenant</a><a href="quick-reference.html">Quick Ref</a></div></div>
        
<h1>Embrix O2X Platform - Newcomer's Guide (Part 1)</h1>

<h2>Business Overview & System Architecture</h2>

<strong>Version</strong>: 3.1.9-SNAPSHOT  
<strong>Last Updated</strong>: February 2026  
<strong>Target Audience</strong>: New developers, business analysts, and technical stakeholders

<hr>

<h2>Table of Contents - Part 1</h2>

<ol>
<li><a href="#1-what-is-embrix-o2x">What is Embrix O2X?</a></li>
<li><a href="#2-business-purpose--use-cases">Business Purpose & Use Cases</a></li>
<li><a href="#3-current-production-deployments">Current Production Deployments</a></li>
<li><a href="#4-system-architecture-overview">System Architecture Overview</a></li>
<li><a href="#5-technology-stack">Technology Stack</a></li>
<li><a href="#6-multi-tenant-architecture">Multi-Tenant Architecture</a></li>
<li><a href="#7-key-business-capabilities">Key Business Capabilities</a></li>
</ol>

<hr>

<h2>1. What is Embrix O2X?</h2>

<h3>1.1 Platform Definition</h3>

<strong>Embrix O2X (Order-to-X)</strong> is an enterprise-grade <strong>telecommunications billing and order management platform</strong> designed for service providers. The platform handles the complete customer lifecycle from order entry through provisioning, usage tracking, billing, invoicing, payment processing, and revenue recognition.
<strong>"Order-to-X" means:</strong>
<ul>
<li><strong>Order-to-Cash</strong>: Order → Provisioning → Billing → Payment</li>
<li><strong>Order-to-Revenue</strong>: Revenue recognition and financial compliance</li>
<li><strong>Order-to-Service</strong>: Service activation and lifecycle management</li>
</ul>
<h3>1.2 Target Market</h3>

<strong>Primary Market:</strong> Telecommunications & Service Providers
<table>
<thead><tr>
<th>Industry Vertical</th>
<th>Business Model</th>
<th>Example Companies</th>
</tr></thead><tbody>
<tr>
<td>-------------------</td>
<td>----------------</td>
<td>-------------------</td>
</tr>
<tr>
<td><strong>Internet Service Providers (ISPs)</strong></td>
<td>Broadband, fiber, wireless internet</td>
<td>Regional ISPs, fixed wireless operators</td>
</tr>
<tr>
<td><strong>Mobile Network Operators (MNOs)</strong></td>
<td>Mobile voice, data, SMS services</td>
<td>Mobile carriers, MVNOs</td>
</tr>
<tr>
<td><strong>Cable Companies</strong></td>
<td>Cable TV, internet, phone bundles</td>
<td>Cable MSOs, regional providers</td>
</tr>
<tr>
<td><strong>VoIP Service Providers</strong></td>
<td>Business VoIP, UCaaS, CCaaS</td>
<td>Cloud communications platforms</td>
</tr>
<tr>
<td><strong>Cloud Service Providers</strong></td>
<td>IaaS, SaaS with usage-based billing</td>
<td>API platforms, cloud infrastructure</td>
</tr>
<tr>
<td><strong>Utility Companies</strong></td>
<td>Water, electricity, gas (expanding)</td>
<td>Multi-utility providers</td>
</tr>
</tbody></table>
<h3>1.3 Problem Statement & Solution</h3>

Traditional telecom billing systems face significant challenges. Embrix O2X provides modern solutions:
<table>
<thead><tr>
<th>Challenge</th>
<th>Legacy System Limitation</th>
<th>Embrix O2X Solution</th>
</tr></thead><tbody>
<tr>
<td>-----------</td>
<td>-------------------------</td>
<td>---------------------</td>
</tr>
<tr>
<td><strong>Complex Pricing</strong></td>
<td>Rigid pricing rules, hard-coded logic</td>
<td>Flexible product catalog with tiered, bundled, volume, and promotional pricing engine</td>
</tr>
<tr>
<td><strong>High-Volume Usage</strong></td>
<td>Batch processing delays, performance bottlenecks</td>
<td>High-performance mediation and rating (millions of CDRs daily in real-time)</td>
</tr>
<tr>
<td><strong>Tax Compliance</strong></td>
<td>Manual tax calculation, compliance risk</td>
<td>Automated multi-country tax (Mexican CFDI, Avalara integration, jurisdiction mapping)</td>
</tr>
<tr>
<td><strong>Provisioning</strong></td>
<td>Manual handoffs, vendor-specific code</td>
<td>Multi-vendor provisioning orchestration with canonical mapping</td>
</tr>
<tr>
<td><strong>Revenue Recognition</strong></td>
<td>Manual accounting, compliance risk</td>
<td>Built-in GAAP-compliant recognition (IFRS 15, ASC 606, deferred revenue)</td>
</tr>
<tr>
<td><strong>System Integration</strong></td>
<td>Point-to-point integrations, tight coupling</td>
<td>Gateway-based architecture (CRM, ERP, payment, tax gateways with canonical APIs)</td>
</tr>
</tbody></table>

<hr>

<h2>2. Business Purpose & Use Cases</h2>

<h3>2.1 Real-World Business Scenarios</h3>

<h4>Scenario 1: New Customer Signs Up for Internet Service</h4>

<strong>Business Flow:</strong>
<pre><code class="language-">Customer submits order via web portal
    ↓
Order validated (address serviceable, credit check)
    ↓
Service provisioned (ONT configured, VLAN assigned)
    ↓
Billing cycle started (prorated first month)
    ↓
Invoice generated with taxes
    ↓
Customer receives email with invoice PDF
    ↓
Payment processed (bank transfer)
    ↓
Payment allocated to invoice
    ↓
Revenue recognized over service period
</code></pre>
<strong>Embrix O2X Components Involved:</strong>
<ul>
<li><code>crm_gateway</code> - Order intake from Salesforce</li>
<li><code>provision_gateway</code> - Nokia/ServiceNow provisioning</li>
<li><code>service-billing</code> - Charge generation</li>
<li><code>tax-gateway</code> - Tax calculation</li>
<li><code>service-invoice</code> - PDF generation</li>
<li><code>service-payment</code> - Payment processing</li>
<li><code>service-revenue</code> - Revenue recognition</li>
</ul>
<h4>Scenario 2: Mobile Customer Makes 100 Phone Calls</h4>

<strong>Business Flow:</strong>
<pre><code class="language-">Network switches generate 100 CDR records
    ↓
CDR file placed on SFTP server
    ↓
Mediation system ingests and normalizes CDRs
    ↓
Rating engine calculates charges (minutes used vs plan quota)
    ↓
Charges accumulated for monthly invoice
    ↓
End of month: Invoice includes usage charges
    ↓
Customer pays invoice
    ↓
Revenue recognized
</code></pre>
<strong>Embrix O2X Components Involved:</strong>
<ul>
<li><code>service-mediation</code> - CDR ingestion and normalization</li>
<li><code>service-usage</code> - Rating and charge calculation</li>
<li><code>service-billing</code> - Monthly billing cycle</li>
<li><code>service-invoice</code> - Invoice generation</li>
<li><code>service-payment</code> - Payment processing</li>
</ul>
<h4>Scenario 3: Customer Payment Restores Suspended Service</h4>

<strong>Business Flow:</strong>
<pre><code class="language-">Customer account has negative balance (overdue invoices)
    ↓
Service automatically suspended (EP-5480 auto-suspend)
    ↓
Customer makes payment via bank transfer
    ↓
Payment file uploaded by bank daily
    ↓
Payment allocated to outstanding invoices
    ↓
Account balance becomes positive
    ↓
System auto-generates RESUME order (EP-5480 enhancement)
    ↓
Service restored on network
    ↓
Customer receives "Service Restored" notification
</code></pre>
<strong>Embrix O2X Components Involved:</strong>
<ul>
<li><code>service-payment</code> - Bank file processing</li>
<li><code>crm_gateway</code> - Auto-resume order generation</li>
<li><code>provision_gateway</code> - Service restoration</li>
<li>Notification service - Customer communication</li>
</ul>
<h3>2.2 Key Business Capabilities</h3>

<strong>Overview</strong>: Embrix O2X delivers eight core business capabilities that power telecommunications and SaaS operations.
<table>
<thead><tr>
<th>#</th>
<th>Capability</th>
<th>Primary Purpose</th>
<th>Key Benefit</th>
</tr></thead><tbody>
<tr>
<td>---</td>
<td>------------</td>
<td>-----------------</td>
<td>-------------</td>
</tr>
<tr>
<td>1</td>
<td>Order Management</td>
<td>Accept and orchestrate service orders</td>
<td>95% automation, real-time validation</td>
</tr>
<tr>
<td>2</td>
<td>Service Provisioning</td>
<td>Network and equipment configuration</td>
<td>Minutes instead of days</td>
</tr>
<tr>
<td>3</td>
<td>Usage Mediation & Rating</td>
<td>Process CDRs and calculate charges</td>
<td>Millions of records daily</td>
</tr>
<tr>
<td>4</td>
<td>Billing & Invoicing</td>
<td>Generate customer invoices</td>
<td>Automated with proration</td>
</tr>
<tr>
<td>5</td>
<td>Payment Processing</td>
<td>Multi-channel payment collection</td>
<td>Improved collection rates</td>
</tr>
<tr>
<td>6</td>
<td>Tax Compliance</td>
<td>Regulatory compliance (CFDI, VAT)</td>
<td>Avoid penalties, audit-ready</td>
</tr>
<tr>
<td>7</td>
<td>Revenue Recognition</td>
<td>GAAP-compliant accounting</td>
<td>IFRS 15 / ASC 606 compliant</td>
</tr>
<tr>
<td>8</td>
<td>Financial Integration</td>
<td>ERP/accounting system sync</td>
<td>Eliminate manual GL entries</td>
</tr>
</tbody></table>

<hr>

<h4>2.2.1 Order Management</h4>

<strong>What it does:</strong>
<ul>
<li>Accepts orders from CRM systems (Salesforce, Dynamics)</li>
<li>Validates order feasibility (service availability, credit limits)</li>
<li>Orchestrates complex fulfillment workflows</li>
<li>Tracks order status through lifecycle</li>
<li>Handles order modifications and cancellations</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Automated order processing reduces manual errors</li>
<li>Real-time validation prevents invalid orders</li>
<li>Order tracking provides transparency to customers and support teams</li>
</ul>

<hr>

<h4>2.2.2 Service Provisioning</h4>

<strong>What it does:</strong>
<ul>
<li>Integrates with network provisioning systems (Nokia, ServiceNow, Cisco)</li>
<li>Assigns network resources (IP addresses, DIDs, VLANs)</li>
<li>Configures customer equipment (ONTs, STBs, routers)</li>
<li>Handles asynchronous provisioning workflows</li>
<li>Manages equipment inventory</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Reduces provisioning time from days to minutes</li>
<li>Eliminates manual configuration errors</li>
<li>Enables zero-touch provisioning for customers</li>
</ul>

<hr>

<h4>2.2.3 Usage Mediation & Rating</h4>

<strong>What it does:</strong>
<ul>
<li>Collects usage data from network elements (voice, SMS, data)</li>
<li>Normalizes diverse CDR formats to canonical format</li>
<li>Deduplicates records to prevent double-billing</li>
<li>Rates usage according to customer pricing plans</li>
<li>Tracks quotas and triggers overage charges</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Processes millions of CDRs daily</li>
<li>Supports complex pricing (tiered, bundled, time-of-day)</li>
<li>Ensures accurate billing for usage-based services</li>
<li>Real-time quota monitoring prevents bill shock</li>
</ul>

<hr>

<h4>2.2.4 Billing & Invoicing</h4>

<strong>What it does:</strong>
<ul>
<li>Generates recurring charges (monthly subscriptions)</li>
<li>Calculates prorated charges for mid-cycle changes</li>
<li>Aggregates usage charges</li>
<li>Calculates taxes (VAT, sales tax, telecom-specific taxes)</li>
<li>Generates customer-facing invoices (PDF, HTML, XML)</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Automated billing reduces manual effort</li>
<li>Accurate proration ensures fair charging</li>
<li>Multi-format invoices support diverse customer preferences</li>
<li>Tax compliance reduces audit risk</li>
</ul>

<hr>

<h4>2.2.5 Payment Processing</h4>

<strong>What it does:</strong>
<ul>
<li>Integrates with payment gateways (Stripe, PayPal, bank transfers)</li>
<li>Processes automated bank file uploads (Banamex, Bancomer, Santander)</li>
<li>Allocates payments to outstanding invoices</li>
<li>Manages payment methods (credit cards, ACH, wire transfer)</li>
<li>Handles payment failures and retries</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Multiple payment options improve collection rates</li>
<li>Automated reconciliation reduces manual effort</li>
<li>Real-time payment processing improves cash flow</li>
</ul>

<hr>

<h4>2.2.6 Tax Compliance</h4>

<strong>What it does:</strong>
<ul>
<li><strong>Mexican CFDI Compliance</strong>: Generates digital invoices (Comprobante Fiscal Digital por Internet)</li>
<li><strong>PAC Integration</strong>: Submits invoices to authorized stamping providers</li>
<li><strong>UUID Tracking</strong>: Tracks digital stamp IDs for audit purposes</li>
<li><strong>SFTP Automation</strong>: Automated file exchange with PAC providers</li>
<li><strong>Audit Trail</strong>: Complete compliance documentation</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Avoids penalties from Mexican tax authority (SAT)</li>
<li>Automated stamping reduces manual effort</li>
<li>Complete audit trail for compliance verification</li>
<li>Supports multi-country expansion</li>
</ul>

<hr>

<h4>2.2.7 Revenue Recognition</h4>

<strong>What it does:</strong>
<ul>
<li><strong>IFRS 15 / ASC 606 Compliance</strong>: Follows international accounting standards</li>
<li><strong>Deferred Revenue</strong>: Tracks prepaid services</li>
<li><strong>Performance Obligations</strong>: Manages revenue recognition schedules</li>
<li><strong>Journal Entry Generation</strong>: Exports to ERP systems</li>
<li><strong>Revenue Reporting</strong>: Financial dashboards and reports</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Ensures compliance with accounting standards</li>
<li>Provides accurate financial reporting</li>
<li>Supports audits and SEC reporting (for public companies)</li>
<li>Automates complex revenue recognition rules</li>
</ul>

<hr>

<h4>2.2.8 Financial Integration</h4>

<strong>What it does:</strong>
<ul>
<li><strong>ERP Integration</strong>: QuickBooks, NetSuite, Oracle EBS, SAP</li>
<li><strong>GL Posting</strong>: Automated general ledger entries</li>
<li><strong>Reconciliation</strong>: Matches billing to financial records</li>
<li><strong>OAuth2 Authentication</strong>: Secure integration with financial systems</li>
</ul>
<strong>Business Value:</strong>
<ul>
<li>Eliminates manual data entry in accounting systems</li>
<li>Ensures consistency between billing and financial data</li>
<li>Reduces month-end close time</li>
<li>Improves financial reporting accuracy</li>
</ul>

<hr>

<h2>3. Current Production Deployments</h2>

<h3>3.1 Live Tenants</h3>

Based on Helm configurations and production deployments:
<table>
<thead><tr>
<th>Tenant</th>
<th>Country</th>
<th>Industry</th>
<th>Services</th>
<th>Status</th>
</tr></thead><tbody>
<tr>
<td>--------</td>
<td>---------</td>
<td>----------</td>
<td>----------</td>
<td>--------</td>
</tr>
<tr>
<td><strong>MCM Telecom</strong></td>
<td>Mexico</td>
<td>Fixed-line ISP</td>
<td>Internet, Voice</td>
<td>Production</td>
</tr>
<tr>
<td><strong>CoopeG</strong></td>
<td>Costa Rica</td>
<td>Cooperative Telecom</td>
<td>Internet, Voice, TV</td>
<td>Production</td>
</tr>
<tr>
<td><strong>CoopeG Energy</strong></td>
<td>Costa Rica</td>
<td>Energy Utility</td>
<td>Electricity Billing</td>
<td>Production</td>
</tr>
<tr>
<td><strong>Urbanos</strong></td>
<td>(TBD)</td>
<td>(TBD)</td>
<td>(TBD)</td>
<td>Development</td>
</tr>
<tr>
<td><strong>SHM</strong></td>
<td>(TBD)</td>
<td>(TBD)</td>
<td>(TBD)</td>
<td>Production</td>
</tr>
</tbody></table>
<h3>3.2 Scale Indicators</h3>

<table>
<thead><tr>
<th>Tenant</th>
<th>Scale/Volume</th>
<th>Integrations</th>
<th>Complexity</th>
</tr></thead><tbody>
<tr>
<td>--------</td>
<td>--------------</td>
<td>--------------</td>
<td>------------</td>
</tr>
<tr>
<td><strong>MCM Telecom</strong> (Mexico)</td>
<td>• Millions of CDRs monthly<br>• Large subscriber base</td>
<td>• Nokia provisioning<br>• ServiceNow ticketing<br>• Multi-bank (Banamex, Bancomer, Banorte, Santander)<br>• PAC for CFDI stamping</td>
<td>• Mexican CFDI compliance<br>• Multi-channel payment<br>• High-volume mediation</td>
</tr>
<tr>
<td><strong>CoopeG</strong> (Costa Rica)</td>
<td>• High transaction volume<br>• Multi-service subscriptions</td>
<td>• Customer self-care portal<br>• Payment gateway<br>• Provisioning systems</td>
<td>• Multi-service bundling (Internet, Voice, TV)<br>• Complex pricing<br>• Cooperative model</td>
</tr>
</tbody></table>

<hr>

<h2>4. System Architecture Overview</h2>

<h3>4.1 Layered Architecture</h3>

<pre><code class="language-">┌─────────────────────────────────────────────────────────────────────┐
│                        EXTERNAL SYSTEMS                              │
│  Salesforce CRM | Nokia Provisioning | Banks | PAC Providers | ERP  │
└────────────┬────────────────────────────────────┬────────────────────┘
             │                                    │
             ▼                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         GATEWAY LAYER                                │
│  crm_gateway (8080) | provision_gateway (8081) | tax-gateway        │
│  payment-gateway | finance-gateway | diameter-gateway               │
│  Purpose: Normalize external data, protect core from changes        │
└────────────┬────────────────────────────────────┬────────────────────┘
             │                                    │
             ▼                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│              MESSAGING & ORCHESTRATION LAYER                         │
│         ActiveMQ Broker (tcp://localhost:61616)                      │
│  Queues: OMS | PROVISIONING_RESPONSE | MEDIATION | USAGE | BULK     │
│  Purpose: Async processing, decoupling, resilience                  │
└────────────┬────────────────────────────────────┬────────────────────┘
             │                                    │
             ▼                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      CORE SERVICES LAYER                             │
│  service-billing | service-invoice | service-usage | service-payment│
│  service-mediation | service-revenue | batch-process                │
│  Purpose: Exposes business capabilities via GraphQL APIs            │
└────────────┬────────────────────────────────────┬────────────────────┘
             │                                    │
             ▼                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                   SHARED FOUNDATION LAYER                            │
│  ENGINE (Business Logic Hubs) | COMMON (DTOs/Enums)                 │
│  oms-component | gateway-common | jobs-common                        │
│  Purpose: Centralized business rules, shared libraries              │
└────────────┬────────────────────────────────────┬────────────────────┘
             │                                    │
             ▼                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    INFRASTRUCTURE LAYER                              │
│  PostgreSQL 10.5 | Redis | ActiveMQ 5.15.9 | Vault | AWS S3         │
│  Purpose: Data persistence, caching, secrets, storage               │
└─────────────────────────────────────────────────────────────────────┘
</code></pre>
<h3>4.2 Architecture Principles</h3>

<strong>Core Architectural Decisions</strong>: Five foundational principles guide all system design decisions.
<table>
<thead><tr>
<th>Principle</th>
<th>Purpose</th>
<th>Key Benefit</th>
</tr></thead><tbody>
<tr>
<td>-----------</td>
<td>---------</td>
<td>-------------</td>
</tr>
<tr>
<td><strong>Shared Engine Pattern</strong></td>
<td>Centralize business logic</td>
<td>Single source of truth, consistency</td>
</tr>
<tr>
<td><strong>Event-Driven Architecture</strong></td>
<td>Async messaging via ActiveMQ</td>
<td>Resilience, scalability, decoupling</td>
</tr>
<tr>
<td><strong>Gateway Pattern</strong></td>
<td>Isolate external systems</td>
<td>Change external APIs without breaking core</td>
</tr>
<tr>
<td><strong>GraphQL-First API</strong></td>
<td>Flexible data fetching</td>
<td>Strongly typed, reduce over-fetching</td>
</tr>
<tr>
<td><strong>Multi-Tenancy</strong></td>
<td>Shared infrastructure per tenant</td>
<td>Cost efficiency, isolation, customization</td>
</tr>
</tbody></table>

<hr>

<h4>4.2.1 Shared Engine Pattern</h4>

<strong>Principle:</strong> Centralize business logic in shared library (<code>engine</code>)
<strong>Why:</strong>
<ul>
<li>Single source of truth for business rules</li>
<li>Consistency across all services</li>
<li>Easier maintenance and testing</li>
<li>Reduced code duplication</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-groovy">// In engine/src/main/groovy/com/embrix/core/engine/billingHub/
class BillingEngine {
    Charge calculateProration(Subscription sub, ProrationModel model) {
        // Complex proration logic used by ALL services
    }
}
// In service-billing (uses engine)
@Autowired
BillingEngine billingEngine
def charge = billingEngine.calculateProration(subscription, ProrationModel.DAYS_IN_MONTH)
</code></pre>

<hr>

<h4>4.2.2 Event-Driven Architecture</h4>

<strong>Principle:</strong> Asynchronous communication via ActiveMQ
<strong>Why:</strong>
<ul>
<li>Resilience: Services can be down without losing messages</li>
<li>Scalability: Queue consumers can scale independently</li>
<li>Decoupling: Services don't need direct dependencies</li>
<li>Retry: Automatic retry with exponential backoff</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-groovy">// crm_gateway publishes order
activemqTemplate.send("OMS", orderMessage)
// provisioning orchestrator consumes
from("activemq://OMS")
    .process(provisioningProcessor)
</code></pre>

<hr>

<h4>4.2.3 Gateway Pattern</h4>

<strong>Principle:</strong> Gateways isolate core from external systems
<strong>Why:</strong>
<ul>
<li>Core services don't know about external system details</li>
<li>External API changes don't break core logic</li>
<li>Easier to swap providers (e.g., change tax provider)</li>
<li>Simplified testing with mocked gateways</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-">service-billing → tax-gateway → [Avalara OR custom tax engine]
                      ↑
                      Changes here don't affect service-billing
</code></pre>

<hr>

<h4>4.2.4 GraphQL-First API</h4>

<strong>Principle:</strong> Core services expose GraphQL endpoints
<strong>Why:</strong>
<ul>
<li>Flexible data fetching (clients request exactly what they need)</li>
<li>Strongly typed schema</li>
<li>Single endpoint for all operations</li>
<li>Built-in documentation (GraphiQL)</li>
<li>Reduces over-fetching and under-fetching</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-graphql"># Client can request only needed fields
query {
  getAccount(id: "ACC-001") {
    id
    balance
    subscriptions {
      priceOfferId
      status
    }
  }
}
</code></pre>

<hr>

<h4>4.2.5 Hub-Based Organization</h4>

<strong>Principle:</strong> Business domains organized into "Hubs" in engine
<strong>Why:</strong>
<ul>
<li>Clear separation of concerns</li>
<li>Team ownership by business domain</li>
<li>Easier navigation of large codebase</li>
<li>Logical grouping of related functionality</li>
</ul>
<strong>Hubs:</strong>
<ul>
<li><code>arHub</code> - Accounts Receivable</li>
<li><code>billingHub</code> - Billing Operations</li>
<li><code>customerHub</code> - Customer Management</li>
<li><code>pricingHub</code> - Product Catalog & Pricing</li>
<li><code>revenueHub</code> - Revenue Recognition</li>
<li><code>usageProcessHub</code> - Usage Rating</li>
<li><code>mediationHub</code> - Usage Data Mediation</li>
<li><code>opsHub</code> - Operations & Admin</li>
</ul>

<hr>

<h2>5. Technology Stack</h2>

<h3>5.1 Backend Technologies</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Version</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>Java</strong></td>
<td>8</td>
<td>Core language</td>
</tr>
<tr>
<td><strong>Groovy</strong></td>
<td>2.4.15</td>
<td>Business logic (more concise than Java)</td>
</tr>
<tr>
<td><strong>Spring Boot</strong></td>
<td>2.1.4</td>
<td>Microservice framework</td>
</tr>
<tr>
<td><strong>Apache Camel</strong></td>
<td>2.22.0 - 2.23.1</td>
<td>Integration and routing</td>
</tr>
<tr>
<td><strong>GraphQL Java</strong></td>
<td>5.0.2</td>
<td>API layer</td>
</tr>
<tr>
<td><strong>JOOQ</strong></td>
<td>3.11.10</td>
<td>Type-safe SQL generation</td>
</tr>
<tr>
<td><strong>Flyway</strong></td>
<td>5.2.4</td>
<td>Database migrations</td>
</tr>
<tr>
<td><strong>Maven</strong></td>
<td>3.6+</td>
<td>Build and dependency management</td>
</tr>
</tbody></table>
<strong>Why Groovy?</strong>
<ul>
<li>Less boilerplate than Java</li>
<li>Native JSON/XML support</li>
<li>Dynamic typing when needed</li>
<li>Seamless Java interoperability</li>
<li>Concise collection operations</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-groovy">// Groovy (concise)
def activeSubscriptions = subscriptions.findAll { it.status == 'ACTIVE' }
def totalRevenue = activeSubscriptions.sum { it.monthlyCharge }
// Equivalent Java (verbose)
List&lt;Subscription&gt; activeSubscriptions = subscriptions.stream()
    .filter(s -&gt; "ACTIVE".equals(s.getStatus()))
    .collect(Collectors.toList());
BigDecimal totalRevenue = activeSubscriptions.stream()
    .map(Subscription::getMonthlyCharge)
    .reduce(BigDecimal.ZERO, BigDecimal::add);
</code></pre>
<h3>5.2 Data Layer</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Version</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>PostgreSQL</strong></td>
<td>10.5+</td>
<td>Primary relational database</td>
</tr>
<tr>
<td><strong>JOOQ</strong></td>
<td>3.11.10</td>
<td>Type-safe SQL queries</td>
</tr>
<tr>
<td><strong>Flyway</strong></td>
<td>5.2.4</td>
<td>Schema version control</td>
</tr>
<tr>
<td><strong>HikariCP</strong></td>
<td>(via Spring Boot)</td>
<td>Connection pooling</td>
</tr>
</tbody></table>
<strong>Why JOOQ over JPA/Hibernate?</strong>
<ul>
<li>✅ Type-safe SQL checked at compile time</li>
<li>✅ Full SQL power (complex joins, CTEs, window functions)</li>
<li>✅ Near-native performance (no ORM overhead)</li>
<li>✅ Excellent for read-heavy workloads</li>
<li>✅ Generated code from schema</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-groovy">// JOOQ query (type-safe)
def invoices = dsl
    .select()
    .from(INVOICE)
    .where(INVOICE.ACCOUNT_ID.eq(accountId))
    .and(INVOICE.STATUS.eq("PENDING"))
    .orderBy(INVOICE.DUE_DATE.asc())
    .fetch()
// Compile error if INVOICE.STATUS doesn't exist!
</code></pre>
<h3>5.3 Messaging & Integration</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Version</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>ActiveMQ</strong></td>
<td>5.15.9</td>
<td>Message broker</td>
</tr>
<tr>
<td><strong>Apache Camel</strong></td>
<td>2.22.0 - 2.23.1</td>
<td>Integration framework</td>
</tr>
</tbody></table>
<strong>ActiveMQ Queues:</strong>
<ul>
<li><code>OMS</code> - Order intake</li>
<li><code>PROVISIONING_RESPONSE</code> - Provisioning callbacks</li>
<li><code>MEDIATION</code> - CDR file processing</li>
<li><code>USAGE</code> - Usage rating</li>
<li><code>BULK</code> - Bulk operations</li>
</ul>
<strong>Retry Policy:</strong>
<pre><code class="language-yaml">maxRetries: 7
initialDelay: 250ms
backoffMultiplier: 1.5x
<h1>Retry delays: 250ms, 375ms, 562ms, 843ms, 1.26s, 1.9s, 2.85s</h1>

</code></pre>
<h3>5.4 Security & Configuration</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Version</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>HashiCorp Vault</strong></td>
<td>2.0.2</td>
<td>Secrets management</td>
</tr>
<tr>
<td><strong>OAuth2</strong></td>
<td>(Spring Security)</td>
<td>Authorization</td>
</tr>
<tr>
<td><strong>JWT</strong></td>
<td>(Spring Security)</td>
<td>Token-based auth</td>
</tr>
</tbody></table>
<strong>Vault Secrets:</strong>
<ul>
<li>Database credentials</li>
<li>ActiveMQ credentials</li>
<li>External API keys (QuickBooks, Stripe, etc.)</li>
<li>JWT signing keys</li>
<li>Slack webhook URLs</li>
</ul>
<h3>5.5 Document Generation</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Version</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>iText</strong></td>
<td>7.1.5</td>
<td>PDF generation</td>
</tr>
<tr>
<td><strong>Apache FOP</strong></td>
<td>2.3</td>
<td>XSL-FO to PDF</td>
</tr>
<tr>
<td><strong>Thymeleaf</strong></td>
<td>3.0.11</td>
<td>HTML templates</td>
</tr>
</tbody></table>
<h3>5.6 Caching & Performance</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Version</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>Redis</strong></td>
<td>6.2+</td>
<td>Caching, real-time counters</td>
</tr>
<tr>
<td><strong>Jedis</strong></td>
<td>(via Spring Data Redis)</td>
<td>Redis client</td>
</tr>
</tbody></table>
<strong>Redis Use Cases:</strong>
<ul>
<li>Pricing catalog cache (fast lookup)</li>
<li>Real-time usage quotas (prepaid balance checks)</li>
<li>Session data</li>
<li>Temporary computation results</li>
</ul>
<h3>5.7 Testing</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Version</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>Spock Framework</strong></td>
<td>1.1-groovy-2.4</td>
<td>BDD testing (Groovy)</td>
</tr>
<tr>
<td><strong>JUnit</strong></td>
<td>4.12</td>
<td>Unit testing (Java)</td>
</tr>
<tr>
<td><strong>Embedded PostgreSQL</strong></td>
<td>2.9</td>
<td>Integration tests</td>
</tr>
<tr>
<td><strong>Embedded Redis</strong></td>
<td>0.7.3</td>
<td>Cache tests</td>
</tr>
</tbody></table>
<strong>Why Spock?</strong>
<ul>
<li>Readable BDD-style tests</li>
<li>Built-in mocking</li>
<li>Data-driven testing</li>
<li>Groovy's expressiveness</li>
</ul>
<strong>Example:</strong>
<pre><code class="language-groovy">def "should calculate correct proration for mid-cycle activation"() {
    given: "a subscription starting mid-month"
    def subscription = new Subscription(
        monthlyPrice: 30.0,
        startDate: LocalDate.of(2024, 1, 16)
    )
    when: "proration is calculated"
    def charge = billingEngine.calculateProration(
        subscription, 
        ProrationModel.DAYS_IN_MONTH
    )
    then: "charge should be prorated for 16 days"
    charge.amount == 15.48  // (30.00 / 31) * 16
    charge.chargeType == ChargeType.RECURRING
}
</code></pre>
<h3>5.8 DevOps & Infrastructure</h3>

<table>
<thead><tr>
<th>Technology</th>
<th>Purpose</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>---------</td>
</tr>
<tr>
<td><strong>Docker</strong></td>
<td>Containerization</td>
</tr>
<tr>
<td><strong>Kubernetes</strong></td>
<td>Container orchestration</td>
</tr>
<tr>
<td><strong>Helm</strong></td>
<td>Deployment configuration</td>
</tr>
<tr>
<td><strong>AWS S3</strong></td>
<td>Document storage</td>
</tr>
<tr>
<td><strong>GitLab CI</strong></td>
<td>CI/CD pipeline</td>
</tr>
</tbody></table>

<hr>

<h2>6. Multi-Tenant Architecture</h2>

<h3>6.1 Deployment-Level Multi-Tenancy</h3>

<strong>Architecture Pattern:</strong> Each tenant gets:
<ul>
<li>✅ Dedicated Kubernetes deployment</li>
<li>✅ Dedicated database (<code>coredb-{tenant-name}</code>)</li>
<li>✅ Dedicated service instances</li>
<li>✅ Shared infrastructure (Kubernetes cluster, RDS instance)</li>
</ul>
<strong>NOT shared-database multi-tenancy with <code>tenant_id</code> columns.</strong>
<h3>6.2 Database Architecture</h3>

<pre><code class="language-">PostgreSQL RDS: embrix-rds-dev-db.chg5bgdk4yyp.us-east-1.rds.amazonaws.com
├── coredb-urbanos (TIDLT-100005)
│   ├── account (no tenant_id column)
│   ├── subscription
│   ├── order
│   ├── invoice
│   └── ...
├── coredb-coopeg-sbx (TIDLT-100001)
│   ├── account (separate data)
│   ├── subscription
│   └── ...
└── coredb-coopegenergy (TIDLT-100007)
    ├── account (separate data)
    └── ...
</code></pre>
<strong>Shared Configuration Schema:</strong>
<pre><code class="language-sql">-- Exists in all tenant databases
core_config.tenant
  ├── id (VARCHAR) - e.g., TIDLT-100005
  ├── name (VARCHAR) - e.g., urbanos
  ├── vaulturi - Vault URL
  └── licensekey
core_config.tenant_merchants
  ├── tenant_id - References tenant.id
  ├── name - QUICKBOOKS, STRIPE, AVALARA, etc.
  ├── type - FINANCE_GATEWAY, PAYMENT_GATEWAY, TAX_GATEWAY
  └── authtype - OAUTH1, OAUTH2, API_KEY
</code></pre>
<h3>6.3 Service Naming Convention</h3>

<pre><code class="language-">Kubernetes Services: {tenant-name}-{service-name}
Examples:
  urbanos-service-transactional
  urbanos-service-billing
  urbanos-payment-gateway
  coopeg-prd-service-transactional
  coopeg-prd-tax-gateway
</code></pre>
<h3>6.4 Tenant Context Injection</h3>

<strong>Via Helm Values:</strong>
<pre><code class="language-yaml">app:
  tenantId: TIDLT-100005
  tenantName: urbanos
  postgres:
    url: jdbc:postgresql://.../coredb-urbanos
  vault:
    api: http://urbanos-vault-interface/
</code></pre>
<strong>In Application Code:</strong>
<pre><code class="language-groovy">@Value('${tenant.id}')
private String tenantId
@Value('${TENANT_ID}')
private String tenant_id
</code></pre>
<h3>6.5 Advantages of This Architecture</h3>

<strong>✅ Strong Data Isolation</strong>
<ul>
<li>Complete database separation</li>
<li>No risk of cross-tenant data leaks</li>
<li>Simplified compliance/auditing</li>
</ul>
<strong>✅ Performance Isolation</strong>
<ul>
<li>One tenant's load doesn't impact others</li>
<li>Dedicated resources per tenant</li>
<li>Independent scaling</li>
</ul>
<strong>✅ Customization Flexibility</strong>
<ul>
<li>Can deploy different versions per tenant</li>
<li>Tenant-specific configuration</li>
<li>Easy A/B testing</li>
</ul>
<strong>✅ Simplified Development</strong>
<ul>
<li>No <code>tenant_id</code> filtering in business logic</li>
<li>No complex query interceptors</li>
<li>Easier testing</li>
</ul>
<strong>✅ Independent Operations</strong>
<ul>
<li>Deploy/upgrade tenants independently</li>
<li>Rollback single tenant without affecting others</li>
<li>Different maintenance windows</li>
</ul>
<h3>6.6 Trade-offs</h3>

<strong>⚠️ Infrastructure Cost</strong>
<ul>
<li>Higher resource usage (one deployment per tenant)</li>
<li>More Kubernetes pods</li>
<li>Database licensing</li>
</ul>
<strong>⚠️ Operational Complexity</strong>
<ul>
<li>More deployments to monitor</li>
<li>More CI/CD pipelines</li>
<li>Helm chart management per tenant</li>
</ul>
<strong>⚠️ Shared Resources</strong>
<ul>
<li>Single RDS instance (potential bottleneck)</li>
<li>Shared Kubernetes cluster</li>
<li>Shared Redis/ActiveMQ</li>
</ul>

<hr>

<h2>7. Key Business Capabilities</h2>

<h3>7.1 Platform Capabilities Matrix</h3>

<table>
<thead><tr>
<th>Capability</th>
<th>Maturity</th>
<th>Complexity</th>
<th>Business Value</th>
</tr></thead><tbody>
<tr>
<td>------------</td>
<td>----------</td>
<td>------------</td>
<td>----------------</td>
</tr>
<tr>
<td>Order Management</td>
<td>Production</td>
<td>Medium</td>
<td>High</td>
</tr>
<tr>
<td>Service Provisioning</td>
<td>Production</td>
<td>High</td>
<td>High</td>
</tr>
<tr>
<td>Usage Mediation</td>
<td>Production</td>
<td>High</td>
<td>Critical</td>
</tr>
<tr>
<td>Usage Rating</td>
<td>Production</td>
<td>High</td>
<td>Critical</td>
</tr>
<tr>
<td>Billing</td>
<td>Production</td>
<td>High</td>
<td>Critical</td>
</tr>
<tr>
<td>Invoicing</td>
<td>Production</td>
<td>Medium</td>
<td>High</td>
</tr>
<tr>
<td>Payment Processing</td>
<td>Production</td>
<td>Medium</td>
<td>High</td>
</tr>
<tr>
<td>Tax Compliance (CFDI)</td>
<td>Production</td>
<td>High</td>
<td>Critical (Mexico)</td>
</tr>
<tr>
<td>Revenue Recognition</td>
<td>Production</td>
<td>Medium</td>
<td>Medium</td>
</tr>
<tr>
<td>Financial Integration</td>
<td>Production</td>
<td>Medium</td>
<td>Medium</td>
</tr>
<tr>
<td>Multi-Tenant</td>
<td>Production</td>
<td>High</td>
<td>High</td>
</tr>
</tbody></table>
<h3>7.2 Integration Capabilities</h3>

<strong>Supported Integrations:</strong>
<table>
<thead><tr>
<th>Category</th>
<th>Systems</th>
<th>Status</th>
</tr></thead><tbody>
<tr>
<td>----------</td>
<td>---------</td>
<td>--------</td>
</tr>
<tr>
<td><strong>CRM</strong></td>
<td>Salesforce</td>
<td>Production</td>
</tr>
<tr>
<td><strong>Provisioning</strong></td>
<td>Nokia, ServiceNow</td>
<td>Production</td>
</tr>
<tr>
<td><strong>Tax</strong></td>
<td>PAC Providers (Mexico)</td>
<td>Production</td>
</tr>
<tr>
<td><strong>Tax</strong></td>
<td>Avalara</td>
<td>Design Phase</td>
</tr>
<tr>
<td><strong>Payment</strong></td>
<td>Stripe, PayPal</td>
<td>Production</td>
</tr>
<tr>
<td><strong>Payment</strong></td>
<td>Mexican Banks</td>
<td>Production</td>
</tr>
<tr>
<td><strong>ERP</strong></td>
<td>QuickBooks</td>
<td>Production</td>
</tr>
<tr>
<td><strong>ERP</strong></td>
<td>NetSuite</td>
<td>Design Phase</td>
</tr>
<tr>
<td><strong>ERP</strong></td>
<td>Oracle EBS</td>
<td>Design Phase</td>
</tr>
<tr>
<td><strong>Notifications</strong></td>
<td>Slack</td>
<td>Production</td>
</tr>
</tbody></table>
<h3>7.3 Business KPIs Supported</h3>

<strong>Operational Metrics:</strong>
<ul>
<li>Orders processed per day</li>
<li>Provisioning success rate</li>
<li>Average provisioning time</li>
<li>CDR processing throughput</li>
<li>Invoice generation time</li>
</ul>
<strong>Financial Metrics:</strong>
<ul>
<li>Monthly recurring revenue (MRR)</li>
<li>Annual recurring revenue (ARR)</li>
<li>Churn rate</li>
<li>Average revenue per user (ARPU)</li>
<li>Collection efficiency</li>
<li>Days sales outstanding (DSO)</li>
</ul>
<strong>Compliance Metrics:</strong>
<ul>
<li>Tax stamping success rate (CFDI)</li>
<li>Revenue recognition accuracy</li>
<li>Billing accuracy</li>
<li>Payment reconciliation rate</li>
</ul>

<hr>

<h2>Summary of Part 1</h2>

You've learned:
<ol>
<li>✅ What Embrix O2X is and why it exists</li>
<li>✅ Real-world business use cases</li>
<li>✅ Current production deployments</li>
<li>✅ High-level system architecture</li>
<li>✅ Technology stack and rationale</li>
<li>✅ Multi-tenant architecture model</li>
<li>✅ Key business capabilities</li>
</ol>
<strong>Next:</strong> Part 2 covers detailed technical architecture, component interactions, and business flows.
<strong>Next:</strong> Part 3 covers development workflows, testing strategies, and operational procedures.</p>
        <footer>
            <p><strong>Embrix O2X Platform Documentation</strong></p>
            <p>Version 3.1.9-SNAPSHOT • Last Updated: February 2026</p>
        </footer>
    </div>
</body>
</html>